# .NET runtime image (Alpine/musl so linux-musl-* self-contained binaries run in both Docker and MicroVM flows)
FROM mcr.microsoft.com/dotnet/runtime-deps:8.0-alpine

# Install nova-agent
COPY bin/nova-agent /usr/local/bin/nova-agent

# Create directories
RUN mkdir -p /code /tmp && chmod 1777 /tmp

# Set environment for Docker mode
ENV NOVA_AGENT_MODE=tcp
ENV NOVA_SKIP_MOUNT=true
ENV DOTNET_ROOT=/usr/share/dotnet

EXPOSE 9999

CMD ["/usr/local/bin/nova-agent"]
